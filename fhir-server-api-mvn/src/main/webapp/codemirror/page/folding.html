<!doctype html>

<head>
<title>CodeMirror: Code Folding Demo</title>
<meta charset="utf-8" />
<link rel=stylesheet href="../doc/docs.css">

<link rel="stylesheet" href="../lib/codemirror.css">
<link rel="stylesheet" href="../addon/fold/foldgutter.css" />
<script src="../lib/codemirror.js"></script>
<script src="../addon/fold/foldcode.js"></script>
<script src="../addon/fold/foldgutter.js"></script>
<script src="../addon/fold/brace-fold.js"></script>
<script src="../addon/fold/xml-fold.js"></script>
<script src="../addon/fold/markdown-fold.js"></script>
<script src="../addon/fold/comment-fold.js"></script>
<script src="../mode/javascript/javascript.js"></script>
<script src="../mode/xml/xml.js"></script>
<script src="../mode/markdown/markdown.js"></script>
<script type="text/javascript" src="../../lib/jquery-1.11.2.min.js"></script>

<script>
	var sessionId="123";
	var cm;
	
	function getAuth() {
	
	$.ajax({
      url: 'http://localhost:8080/fhir-server-api-mvn/resources/i2b2/login',
      type: 'POST',
  	   data: $("form1").serialize(), // serializes the form's elements.
  	   dataType: 'text',
           success: function(data)
           {
               alert(data); // show response from the php script.
           },
           error: function(data)
           {
               alert(data); // show response from the php script.
           }
        });
};

function getPatients() {
		$.ajax({
			url : 'http://localhost:8080/fhir-server-api-mvn/resources/i2b2/Patient;jsessionid='+sessionId,
			xhrFields: {
      			withCredentials: true
   			},
			type : 'GET',
			dataType: 'text',
			success : function(data) {
				//alert( );
				setXmlDisplay2(data);
			}
		});
	};

	function setXmlDisplay(displayText) {
		var te_html = document.getElementById("code-xml");
		te_html.value = displayText;
		cm = CodeMirror.fromTextArea(te_html, {
			mode : "text/xml",
			lineNumbers : true,
			lineWrapping : true,
			extraKeys : {
				"Ctrl-Q" : function(cm) {
					cm.foldCode(cm.getCursor());
				}
			},
			foldGutter : true,
			gutters : [ "CodeMirror-linenumbers", "CodeMirror-foldgutter" ]
		});
	};
	
	function setXmlDisplay2(displayText) {
		var old_te_html = document.getElementById("code-xml");
		old_te_html.parentNode.style.display="none";
		
		var te_html = document.getElementById("code-xml2");
		te_html.value = displayText;
		te_html.parentNode.style.display="block";
		cm = CodeMirror.fromTextArea(te_html, {
			mode : "text/xml",
			lineNumbers : true,
			lineWrapping : true,
			extraKeys : {
				"Ctrl-Q" : function(cm) {
					cm.foldCode(cm.getCursor());
				}
			},
			foldGutter : true,
			gutters : [ "CodeMirror-linenumbers", "CodeMirror-foldgutter" ]
		});
		
	}
	
	
</script>
<style type="text/css">
.CodeMirror {
	border-top: 1px solid black;
	border-bottom: 1px solid black;
}
</style>
</head>

<body>

	<div id=nav>
		<!--   <a href="http://codemirror.net"><h1>CodeMirror</h1><img id=logo src="../doc/logo.png"></a>
-->

	</div>
	<div id=myform
		style="max-width: 100em; margin-bottom: 1em:display:block; font-size: 10px;">
		<form id=form1 enctype="application/x-www-form-urlencoded" action="http://localhost:8080/fhir-server-api-mvn/resources/i2b2/login">
			Username:<input type="text" name="username" value="demo">
			Password:<input type="text" name="password" value="demouser">
			I2B2Domain:<input type="text" name="i2b2domain" value="i2b2demo">
			I2B2Url:<input type="text" name="i2b2url"
				value="http://services.i2b2.org:9090/i2b2"> <input
				type="submit" value="Submit">

		</form>
	</div>
	<article>
		<h2>Code Folding Demo</h2>
		<form>

			<div
				style="max-width: 100em; margin-bottom: 1em:display:block; font-size: 10px;">
				XML:<br>
				<textarea id="code-xml"></textarea>
			</div>

			<div
				style="max-width: 100em; margin-bottom: 1em; display: none; font-size: 10px;">
				XML2:<br>
				<textarea id="code-xml2"></textarea>
			</div>
		</form>
		<script>
			window.onload = getAuth() ;//setXmlDisplay("<a><b>c</b></a>")
		</script>
	</article>
</body>
